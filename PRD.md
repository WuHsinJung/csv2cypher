# 產品需求文件 (PRD)
## CSV/Excel 轉 Neo4j Cypher 語句轉換工具

### 1. 專案概述

#### 1.1 專案名稱
CSV/Excel 轉 Neo4j Cypher 語句轉換工具

#### 1.2 專案目標
簡化教育知識圖譜的建立過程，讓使用者能夠透過簡單的CSV/Excel檔案，自動生成Neo4j資料庫的Cypher語句，大幅降低知識圖譜建置的技術門檻。

#### 1.3 目標使用者
- 教育工作者（教師、課程設計師）
- 教育科技開發者
- 知識圖譜研究者
- 需要建立教育知識關係的機構

#### 1.4 核心價值主張
- **降低技術門檻**：無需深入了解Neo4j語法，透過熟悉的Excel/CSV格式即可建立知識圖譜
- **提升效率**：自動化轉換過程，節省大量手動編寫Cypher語句的時間
- **標準化流程**：提供統一的資料格式標準，便於知識圖譜的建立和維護

### 2. 功能需求

#### 2.1 核心功能

##### 2.1.1 檔案格式支援
- **輸入格式**：CSV (.csv)、Excel (.xlsx, .xls)
- **編碼支援**：自動檢測並支援UTF-8、Big5、GBK、GB2312、CP950等編碼
- **檔案類型**：知識點檔案 + 先備關係檔案

##### 2.1.2 知識點檔案處理
**必填欄位：**
- `Label`：節點標籤（如：KnowledgePoint）
- `Name`：知識點名稱（主要識別屬性）
- `Education System`：教育階段（如：Elementary School、Junior High School、High School）
- `Subject`：學科領域（如：math、chinese、english）
- `IsRoot`：是否為根節點（TRUE/FALSE，空白視為TRUE）

**選填欄位：**
- `ID`：知識點編號
- `第一層知識`：知識分類第一層
- `第二層知識`：知識分類第二層
- `第三層知識`：知識分類第三層
- `Learning Performance`：學習表現描述

##### 2.1.3 先備關係檔案處理
**必填欄位：**
- `Types`：關係類型（如：Prerequisite）
- `Prerequisite`：先備知識點名稱（支援多個，換行分隔）
- `Target`：目標知識點名稱

**特殊處理：**
- 支援多個先備知識點（換行分隔）
- 自動跳過空白或"無"的先備知識點
- 智能處理關係建立

##### 2.1.4 輸出功能
- **知識點節點**：生成CREATE節點的Cypher語句
- **先備關係**：生成MATCH和CREATE關係的Cypher語句
- **完整腳本**：包含節點創建、關係建立、索引創建和查詢範例的完整腳本
- **索引優化**：自動建立索引以提升查詢效能

#### 2.2 輔助功能

##### 2.2.1 檔案管理
- 自動檢測可用的檔案組合
- 互動式檔案選擇
- 命令列參數支援

##### 2.2.2 資料驗證
- 必要欄位檢查
- 資料完整性驗證
- 錯誤訊息提示

##### 2.2.3 輸出管理
- 自動建立output目錄
- 分類輸出檔案
- 檔案命名規範化

### 3. 非功能需求

#### 3.1 效能需求
- 支援處理大型CSV檔案（1000+行）
- 轉換速度：1000行資料應在10秒內完成
- 記憶體使用：不超過500MB

#### 3.2 相容性需求
- **Python版本**：3.7+
- **作業系統**：Windows、macOS、Linux
- **編碼支援**：多語言編碼自動檢測

#### 3.3 可用性需求
- **易用性**：無需技術背景即可使用
- **錯誤處理**：清晰的錯誤訊息和解決建議
- **文件完整性**：詳細的使用說明和範例

#### 3.4 可維護性需求
- 模組化設計
- 清晰的程式碼結構
- 完整的註解和文檔

### 4. 使用者體驗設計

#### 4.1 使用流程
1. **準備檔案**：準備符合格式的CSV/Excel檔案
2. **執行程式**：選擇檔案或使用預設檔案
3. **自動轉換**：程式自動檢測編碼並轉換
4. **取得結果**：獲得可直接使用的Cypher語句檔案
5. **匯入Neo4j**：複製貼上到Neo4j瀏覽器執行

#### 4.2 互動設計
- **命令列介面**：簡潔明瞭的提示訊息
- **檔案選擇**：智能檔案檢測和選擇
- **進度顯示**：轉換過程的狀態提示
- **結果展示**：清晰的輸出檔案路徑和說明

### 5. 技術架構

#### 5.1 核心技術
- **Python**：主要開發語言
- **pandas**：CSV/Excel檔案處理
- **chardet**：檔案編碼自動檢測
- **pathlib**：檔案路徑處理

#### 5.2 架構設計
```
csv2cypher/
├── csv2cypher.py          # 主程式（使用者介面）
├── converter.py            # 轉換器模組（核心邏輯）
├── requirements.txt        # 依賴管理
├── README.md              # 使用說明
└── output/                # 輸出目錄
```

#### 5.3 模組職責
- **主程式**：使用者介面、檔案管理、流程控制
- **轉換器**：檔案讀取、資料處理、Cypher語句生成
- **編碼檢測**：自動識別檔案編碼格式

### 6. 資料流程

#### 6.1 輸入資料
```
CSV/Excel檔案 → 編碼檢測 → 資料讀取 → 資料驗證
```

#### 6.2 處理流程
```
資料清理 → 欄位映射 → 屬性處理 → Cypher語句生成
```

#### 6.3 輸出資料
```
節點語句 + 關係語句 + 索引語句 + 查詢範例 → 完整腳本
```

### 7. 品質保證

#### 7.1 測試策略
- **單元測試**：各模組功能測試
- **整合測試**：完整流程測試
- **相容性測試**：不同編碼和檔案格式測試

#### 7.2 錯誤處理
- **檔案錯誤**：檔案不存在、格式錯誤
- **編碼錯誤**：無法識別的編碼格式
- **資料錯誤**：缺少必要欄位、資料格式不正確

#### 7.3 效能監控
- 檔案處理時間
- 記憶體使用量
- 錯誤發生頻率

### 8. 部署與維護

#### 8.1 部署方式
- **本地安裝**：pip install -r requirements.txt
- **可執行檔**：未來可考慮打包為exe檔案
- **容器化**：Docker容器部署

#### 8.2 維護計畫
- **版本更新**：定期更新依賴套件
- **功能擴展**：根據使用者回饋增加新功能
- **問題修復**：及時修復發現的問題

### 9. 成功指標

#### 9.1 功能指標
- 支援的檔案格式數量
- 編碼檢測準確率
- 轉換成功率

#### 9.2 使用者指標
- 使用者滿意度
- 使用頻率
- 錯誤回報率

#### 9.3 技術指標
- 程式執行速度
- 記憶體使用效率
- 程式碼品質

### 10. 風險評估

#### 10.1 技術風險
- **編碼檢測失敗**：可能導致檔案無法讀取
- **檔案格式變更**：CSV格式標準變更
- **依賴套件更新**：第三方套件相容性問題

#### 10.2 緩解措施
- 多重編碼檢測機制
- 靈活的欄位映射
- 版本鎖定和測試

### 11. 未來規劃

#### 11.1 短期目標（1-3個月）
- 完善錯誤處理機制
- 增加更多檔案格式支援
- 優化使用者介面

#### 11.2 中期目標（3-6個月）
- 開發圖形化使用者介面
- 增加資料預覽功能
- 支援更多資料庫格式

#### 11.3 長期目標（6-12個月）
- 雲端服務版本
- 協作功能
- 進階分析功能

### 12. 附錄

#### 12.1 術語表
- **Cypher**：Neo4j圖資料庫的查詢語言
- **知識圖譜**：表示知識實體及其關係的圖形結構
- **先備關係**：學習知識點之間的依賴關係

#### 12.2 參考資料
- Neo4j官方文檔
- Cypher查詢語言規範
- 教育知識圖譜相關研究

---

**文件版本**：1.0  
**最後更新**：2024年12月  
**負責人**：開發團隊  
**審核人**：產品經理
